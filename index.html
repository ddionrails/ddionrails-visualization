<!DOCTYPE html>
<html>
    <head>
        <title>Visualization</title>
		
		<!-- D3.js -->
		<script src="http://d3js.org/d3.v2.js"></script>   
		
		<script src="./cat_uni.js"></script>	
		<script src="./cat_bi_sex.js"></script>	
		<script src="./cat_bi_perc.js"></script>	
		<link rel="stylesheet" href="./style.css" />
                
    </head>
	
    <body>
	

		<div id="topMenu"></div>
		<div id="sideMenu"></div>
		<div id="chart"></div>
		
		
    
		<script>
		 
			var w =600;
			var h = 50;

			var margin_left = 70;
			var margin_right = 20;
			var margin_top = 10;
			var margin_bottom = 10;
			
			var barHeight = 10;
			//var barWidth = (w - margin_left - margin_right)/4;
			var barWidth = 40;
			
			topMenu = ["frequencies","age", "sex", "sample", "wave"];
			sideMenu = ["absolute", "percentage", "missings", "weights"]
			
			var hideMissings = false;
			
			var svg = d3.select("#topMenu")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
						
			var xScale = d3.scale.ordinal()
						.domain(topMenu)
						.rangeBands([0, w - margin_left - margin_right]);
						
			var xScale2 = d3.scale.ordinal()
						.domain(sideMenu)
						.rangeBands([0, w - margin_left - margin_right]);
						
			var svg2 = d3.select("#sideMenu")
						.append("svg")
						.attr("width", w)
						.attr("height", h);	
						
			var yScale = d3.scale.ordinal()
							.domain(sideMenu)
							.rangeBands([(h-margin_top - margin_bottom - barHeight), 0]);
							
							
			
			/**
			var sideMenu = svg.selectAll("g")
							.data(sideMenu)
							.enter()
							.append("g")
							.attr("transform", "translate(0," + margin_top + ")");	

			sideMenu.append("rect")
					.attr("x", w-margin_right - barWidth)
					.attr("y", function(d, i){return yScale(i)})
					.attr("height", barHeight)
					.attr("width", barWidth)
					.attr("fill", "none")
					.attr("class", "button")

			
			sideMenu.append("text")
					.attr("x", w-margin_right-barWidth)
					.attr("y", function(d, i){return yScale(i)+ barHeight/2})
					.text(function(d){ return d})
					.attr("text-anchor", "center")
					.attr("font-weight", "bold")
					.attr("fill", "grey")
					.on("click", function() {console.log(d3.select(this))});
			**/		
			
			var topMenu = svg.selectAll("g")
							.data(topMenu)
							.enter()
							.append("g")
							.attr("transform", "translate(" + margin_left + "," + margin_top+")");			
			
			
				
			topMenu.append("rect")
					.attr("x", function(d, i){return xScale(i)})
					.attr("y", 10)
					.attr("height", barHeight)
					.attr("width", barWidth)
					.attr("fill", "none")
					.attr("class", "button")
					.on("click", function(){
						console.log("Hier")
						console.log(d3.select(this))
							//.attr("fill", "red");
			});
					
				

			var current = "frequencies";
			var active = false;
			
			topMenu.append("text")
					.attr("x", function(d, i){return xScale(i) + barWidth/2})
					.attr("y", margin_top + barHeight*(2/3))
					.text(function(d){ return d})
					.attr("text-anchor", "center")
					.attr("font-weight", "bold")
					.attr("fill", "grey")
					.attr("font-family", "sans-serif")
					.attr("font-size", "12px")
					.on("click", function(d){
							
							if(active == false){
								d3.select(this).style("fill", "steelblue");
								active = true;
							}
							else{
								d3.select(this).style("fill", "grey");
								active = false;
							}
							
							current = d;
							modes[current]();
					});
					
			cat_uni();

					
			var sideMenu = svg2.selectAll("g")
							.data(sideMenu)
							.enter()
							.append("g")
							.attr("transform", "translate(" + margin_left + "," + margin_top+")");			
			
			sideMenu.append("rect")
					.attr("x", function(d, i){return xScale2(i)})
					.attr("y", 20)
					.attr("height", barHeight)
					.attr("width", barWidth)
					.attr("fill", "white")
					.attr("class", "button");
					
			var missingx = function(){
				hideMissings ^= true;
			}		

			modes = {
			
				frequencies:	cat_uni,
				sex:			cat_bi_sex,
				percentage: 	cat_bi_perc,
				missings:		missingx,
				
			}
					
			var currentx;
			sideMenu.append("text")
					.attr("x", function(d, i){return xScale2(i) + barWidth/2})
					.attr("y", margin_top + barHeight*(2/3))
					.text(function(d){ return d})
					.attr("text-anchor", "center")
					.attr("font-weight", "bold")
					.attr("fill", "grey")
					.attr("font-family", "sans-serif")
					.attr("font-size", "12px")
					.on("click", function(d){
					
							if(active == false){
								d3.select(this).style("fill", "steelblue");
								active = true;
							}
							else{
								d3.select(this).style("fill", "grey");
								active = false;
							}
							
							currentx = d;
							console.log(currentx)
							modes[currentx]();
							console.log(current)
							modes[current]();
					});
					
			
			
		
			
			
							
			
							
						
			
						
		</script>
		</body>
</html>