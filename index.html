<!DOCTYPE html>
<html>
    <head>
        <title>Visualization</title>
		
		<!-- D3.js -->
		<script src="http://d3js.org/d3.v2.js"></script>   
		
		<script src="./cat_uni.js"></script>	
		<script src="./cat_bi_sex.js"></script>	
		<script src="./cat_bi_perc.js"></script>	
		<link rel="stylesheet" href="./style.css" />
                
    </head>
	
    <body>
	
		<div id="topMenu"></div>
		<div id="chart"></div>
		

		<script>
		
		 
			var w =422.75;
			var h = 41;

			var barHeight = 15;
			
			//var barWidth = 50;
			
			topMenu = ["age", "sex", "sample", "wave"];
			sideMenu = ["percent", "missings", "weights"]
			
			var barWidth = (w/topMenu.length) - 20;
			
			var hideMissings = false;
			
			var svg3 = d3.select("#topMenu")
						.append("svg")
						.attr("width", 100)
						.attr("height", h);	
			
			var svg = d3.select("#topMenu")
						.append("svg")
						.attr("width", 250)
						.attr("height", h)
						.attr("fill", "green");
						
			var xScale = d3.scale.ordinal()
						.domain(topMenu)
						.rangeBands([10, 250]);
						
			var xScale2 = d3.scale.ordinal()
						.domain(sideMenu)
						.rangeBands([65, 250]);
						
			var svg2 = d3.select("#topMenu")
						.append("svg")
						.attr("width", 250)
						.attr("height", 41)
						.attr("fill", "red");
		
							
			var missingx = function(){
				hideMissings ^= true;
			}		

			modes = {
			
				frequencies:	cat_uni,
				sex:			cat_bi_sex,
				"%"				: 	cat_bi_perc,
				"missings":		missingx,
				
			}
					
			
							
							
			
			/**
			var sideMenu = svg.selectAll("g")
							.data(sideMenu)
							.enter()
							.append("g")
							.attr("transform", "translate(0," + margin_top + ")");	

			sideMenu.append("rect")
					.attr("x", w-margin_right - barWidth)
					.attr("y", function(d, i){return yScale(i)})
					.attr("height", barHeight)
					.attr("width", barWidth)
					.attr("fill", "none")
					.attr("class", "button")

			
			sideMenu.append("text")
					.attr("x", w-margin_right-barWidth)
					.attr("y", function(d, i){return yScale(i)+ barHeight/2})
					.text(function(d){ return d})
					.attr("text-anchor", "center")
					.attr("font-weight", "bold")
					.attr("fill", "grey")
					.on("click", function() {console.log(d3.select(this))});
			**/		
			
			var topMenu = svg.selectAll("g")
							.data(topMenu)
							.enter()
							.append("g")
							//.attr("transform", "translate(40,10)");		
			
			var sideMenu = svg2.selectAll("g")
							.data(sideMenu)
							.enter()
							.append("g")
							//.attr("transform", "translate(500,0)");			

			svg3.append("text")
				.text("Education")
				.attr("x", 10)
				.attr("y", 10 + barHeight*2/3)
				.attr("class", "var-name")
				//.attr("transform", "translate(40,10)");	
			
			
			var active = false;	
			

			topMenu.append("circle")
					.attr("cx", function(d, i){return xScale(i)})
					.attr("cy", 16)
					.attr("r", 5)
					//.attr("height", barHeight)
					//.attr("width", barWidth)
					.attr("fill", "#f2f2f2")
					.attr("stroke", "grey")
					.attr("stroke-width", .1)
					.attr("class", "button")
					/**.on("click", function(){
						if(active == false){
								d3.select(this).attr("fill", "grey");
								active = true;
							}
							else{
								d3.select(this).attr("fill", "none");
								active = false;
							}
							
						
			});**/
				var active = false
			sideMenu.append("circle")
					.attr("cx", function(d, i){return xScale2(i)})
					.attr("cy", 16)
					.attr("r", 5)
					//.attr("height", barHeight)
					//.attr("width", barWidth)
					.attr("fill", "#f2f2f2")
					.attr("stroke", "grey")
					.attr("stroke-width", .1)
					.attr("class", "button")
					.on("click", function(d){
							
							if(active == false){
								d3.select(this).attr("fill", "black");
								active = true;
							}
							else{
								d3.select(this).attr("fill", "grey");
								active = false;
							}
					});
					
		;		
			var current = "frequencies";
			topMenu.append("text")
					.attr("x", function(d, i){return xScale(i) + 10})
					.attr("y", 10 + barHeight*2/3)
					.text(function(d){ return d})
					.attr("text-anchor", "left")
					.attr("font-weight", "")
					.attr("fill", "grey")
					.attr("font-family", "sans-serif")
					.attr("font-size", "11px")
					.on("click", function(d){
							
							if(active == false){
								d3.select(this).attr("fill", "black");
								active = true;
							}
							else{
								d3.select(this).attr("fill", "grey");
								active = false;
							}
							
							current = d;
							modes[current]();
					});
					
			cat_uni();				
		
			var barHeight = 15;			
			var currentx;
			sideMenu.append("text")
					.attr("x", function(d, i){return xScale2(i) + 10})
					.attr("y", 10 + barHeight*2/3)
					.text(function(d){ return d})
					.attr("text-anchor", "left")
					.attr("font-weight", "")
					.attr("fill", "grey")
					.attr("font-family", "sans-serif")
					.attr("font-size", "11px")
					.on("click", function(d){
							
							if(active == false){
								d3.select(this).attr("fill", "black");
								active = true;
							}
							else{
								d3.select(this).attr("fill", "grey");
								active = false;
							}
							
				
							
							currentx = d;
							console.log(currentx)
							modes[currentx]();
							console.log(current)
							modes[current]();
					});
			
			
					
			
			
		
			
			
							
			
							
						
			
						
		</script>
		</body>
</html>